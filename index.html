<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LinkedIn Post Analytics - IRD</title>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            background: linear-gradient(to bottom right, #1a4d5c, #2d1b4e);
            min-height: 100vh;
            font-family: system-ui, -apple-system, sans-serif;
        }
        .container { max-width: 72rem; margin: 0 auto; padding: 2rem; }
        .text-center { text-align: center; }
        .mb-4 { margin-bottom: 1rem; }
        .mb-6 { margin-bottom: 1.5rem; }
        .mb-12 { margin-bottom: 3rem; }
        .mx-auto { margin-left: auto; margin-right: auto; }
        .ml-4 { margin-left: 1rem; }
        .p-2 { padding: 0.5rem; }
        .p-6 { padding: 1.5rem; }
        .p-12 { padding: 3rem; }
        .px-4 { padding-left: 1rem; padding-right: 1rem; }
        .py-2 { padding-top: 0.5rem; padding-bottom: 0.5rem; }
        .px-8 { padding-left: 2rem; padding-right: 2rem; }
        .py-3 { padding-top: 0.75rem; padding-bottom: 0.75rem; }
        .text-xl { font-size: 1.25rem; line-height: 1.75rem; }
        .text-2xl { font-size: 1.5rem; line-height: 2rem; }
        .text-5xl { font-size: 3rem; line-height: 1; }
        .text-lg { font-size: 1.125rem; line-height: 1.75rem; }
        .text-sm { font-size: 0.875rem; line-height: 1.25rem; }
        .text-xs { font-size: 0.75rem; line-height: 1rem; }
        .text-white { color: rgb(255, 255, 255); }
        .text-gray-300 { color: rgb(209, 213, 219); }
        .text-gray-400 { color: rgb(156, 163, 175); }
        .font-light { font-weight: 300; }
        .font-semibold { font-weight: 600; }
        .rounded-lg { border-radius: 0.5rem; }
        .rounded-2xl { border-radius: 1rem; }
        .cursor-pointer { cursor: pointer; }
        .transition-all { transition: all 0.3s; }
        .transition-opacity { transition: opacity 0.3s; }
        .hover\:opacity-90:hover { opacity: 0.9; }
        .hidden { display: none; }
        .inline-block { display: inline-block; }
        .flex { display: flex; }
        .items-center { align-items: center; }
        .items-start { align-items: flex-start; }
        .justify-between { justify-content: space-between; }
        .gap-2 { gap: 0.5rem; }
        .gap-4 { gap: 1rem; }
        .flex-1 { flex: 1; }
        .flex-wrap { flex-wrap: wrap; }
        .w-4 { width: 1rem; }
        .h-4 { height: 1rem; }
        .w-5 { width: 1.25rem; }
        .h-5 { height: 1.25rem; }
        .w-16 { width: 4rem; }
        .h-16 { height: 4rem; }
        .grid { display: grid; }
        .grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); }
        .space-y-6 > * + * { margin-top: 1.5rem; }
        @media (min-width: 768px) {
            .md\:grid-cols-5 { grid-template-columns: repeat(5, minmax(0, 1fr)); }
        }
        .gradient-button {
            background: linear-gradient(to right, #20B2AA, #9370DB);
        }
        .post-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .post-card:hover {
            border-color: #20B2AA;
        }
        .sort-button-active {
            background: linear-gradient(to right, #20B2AA, #9370DB);
        }
        .sort-button-inactive {
            background: rgba(255, 255, 255, 0.05);
        }
        .sort-button-inactive:hover {
            background: rgba(255, 255, 255, 0.1);
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="mb-12 text-center">
            <h1 class="text-5xl font-light text-white mb-4">
                LinkedIn Post Analytics
            </h1>
            <p class="text-xl text-gray-300">
                Discover what's working in your content strategy
            </p>
        </div>

        <!-- Upload Section -->
        <div id="uploadSection" class="post-card rounded-2xl p-12 text-center">
            <svg class="w-16 h-16 mx-auto mb-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
            </svg>
            <h2 class="text-2xl font-light text-white mb-4">
                Upload Your LinkedIn Data
            </h2>
            <p class="text-gray-300 mb-6">
                Export your posts from LinkedIn and upload the CSV or Excel file
            </p>
            <label class="inline-block">
                <input type="file" id="fileInput" accept=".csv,.xlsx,.xls" class="hidden">
                <div class="px-8 py-3 gradient-button text-white rounded-lg cursor-pointer hover:opacity-90 transition-opacity">
                    Choose CSV or Excel File
                </div>
            </label>
        </div>

        <!-- Posts Display Section (hidden initially) -->
        <div id="postsSection" class="hidden">
            <!-- Sort Controls -->
            <div class="post-card rounded-2xl p-6 mb-6">
                <div class="flex items-center gap-4 flex-wrap">
                    <span class="text-white font-light">Sort by:</span>
                    <button onclick="sortPosts('impressions')" class="sort-btn px-4 py-2 rounded-lg transition-all sort-button-active text-white" data-metric="impressions">
                        Impressions
                    </button>
                    <button onclick="sortPosts('engagementRate')" class="sort-btn px-4 py-2 rounded-lg transition-all sort-button-inactive text-gray-300" data-metric="engagementRate">
                        Engagement Rate
                    </button>
                    <button onclick="sortPosts('likes')" class="sort-btn px-4 py-2 rounded-lg transition-all sort-button-inactive text-gray-300" data-metric="likes">
                        Likes
                    </button>
                    <button onclick="sortPosts('comments')" class="sort-btn px-4 py-2 rounded-lg transition-all sort-button-inactive text-gray-300" data-metric="comments">
                        Comments
                    </button>
                    <button onclick="sortPosts('reposts')" class="sort-btn px-4 py-2 rounded-lg transition-all sort-button-inactive text-gray-300" data-metric="reposts">
                        Reposts
                    </button>
                </div>
            </div>

            <!-- Posts Container -->
            <div id="postsContainer" class="space-y-6"></div>
        </div>
    </div>

    <script>
        let postsData = [];
        let currentSort = 'impressions';

        document.getElementById('fileInput').addEventListener('change', function(event) {
            const file = event.target.files[0];
            if (!file) return;

            const fileName = file.name.toLowerCase();
            const reader = new FileReader();
            
            if (fileName.endsWith('.csv')) {
                reader.onload = function(e) {
                    const text = e.target.result;
                    parseCSV(text);
                };
                reader.readAsText(file);
            } else if (fileName.endsWith('.xlsx') || fileName.endsWith('.xls')) {
                reader.onload = function(e) {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, { type: 'array' });
                    const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
                    const csv = XLSX.utils.sheet_to_csv(firstSheet);
                    parseCSV(csv);
                };
                reader.readAsArrayBuffer(file);
            }
        });

        function parseCSV(text) {
            const rows = text.split('\n');
            const headers = rows[0].split(',').map(h => h.trim().replace(/"/g, '').toLowerCase());
            
            postsData = rows.slice(1)
                .filter(row => row.trim())
                .map((row, index) => {
                    const values = row.split(',').map(v => v.trim().replace(/"/g, ''));
                    const post = {};
                    headers.forEach((header, i) => {
                        post[header] = values[i] || '';
                    });
                    
                    const impressions = parseInt(post.impressions || 0) || 0;
                    const comments = parseInt(post.comments || 0) || 0;
                    const reposts = parseInt(post.reposts || post.shares || 0) || 0;
                    const likes = parseInt(post.likes || post.reactions || 0) || 0;
                    
                    const engagementRate = impressions > 0 
                        ? ((comments + reposts + likes) / impressions * 100)
                        : 0;
                    
                    return {
                        id: index,
                        text: post.text || post.content || post.post || '',
                        date: post.date || post.posted || post.timestamp || '',
                        impressions,
                        comments,
                        reposts,
                        likes,
                        url: post.url || post.link || post.posturl || '',
                        engagementRate: parseFloat(engagementRate.toFixed(2))
                    };
                });

            displayPosts();
            document.getElementById('uploadSection').classList.add('hidden');
            document.getElementById('postsSection').classList.remove('hidden');
        }

        function sortPosts(metric) {
            currentSort = metric;
            
            // Update button styles
            document.querySelectorAll('.sort-btn').forEach(btn => {
                if (btn.dataset.metric === metric) {
                    btn.className = 'sort-btn px-4 py-2 rounded-lg transition-all sort-button-active text-white';
                } else {
                    btn.className = 'sort-btn px-4 py-2 rounded-lg transition-all sort-button-inactive text-gray-300';
                }
            });
            
            displayPosts();
        }

        function displayPosts() {
            const sorted = [...postsData].sort((a, b) => b[currentSort] - a[currentSort]);
            const container = document.getElementById('postsContainer');
            
            container.innerHTML = sorted.map(post => `
                <div class="post-card rounded-2xl p-6">
                    <div class="flex justify-between items-start mb-4">
                        <div class="flex-1">
                            <p class="text-white text-lg mb-4">
                                ${escapeHtml(post.text)}
                            </p>
                            <p class="text-gray-400 text-sm">${escapeHtml(post.date)}</p>
                        </div>
                        ${post.url ? `
                            <a href="${escapeHtml(post.url)}" target="_blank" rel="noopener noreferrer" 
                               class="ml-4 p-2 gradient-button rounded-lg hover:opacity-90 transition-opacity">
                                <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path>
                                </svg>
                            </a>
                        ` : ''}
                    </div>

                    <div class="grid grid-cols-2 md:grid-cols-5 gap-4 text-white">
                        <div class="flex items-center gap-2">
                            <svg class="w-4 h-4" style="color: #20B2AA;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
                            </svg>
                            <div>
                                <div class="text-xs text-gray-400">Impressions</div>
                                <div class="font-semibold">${post.impressions.toLocaleString()}</div>
                            </div>
                        </div>

                        <div class="flex items-center gap-2">
                            <svg class="w-4 h-4" style="color: #9370DB;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path>
                            </svg>
                            <div>
                                <div class="text-xs text-gray-400">Engagement</div>
                                <div class="font-semibold">${post.engagementRate}%</div>
                            </div>
                        </div>

                        <div class="flex items-center gap-2">
                            <svg class="w-4 h-4" style="color: rgb(244, 114, 182);" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path>
                            </svg>
                            <div>
                                <div class="text-xs text-gray-400">Likes</div>
                                <div class="font-semibold">${post.likes.toLocaleString()}</div>
                            </div>
                        </div>

                        <div class="flex items-center gap-2">
                            <svg class="w-4 h-4" style="color: rgb(96, 165, 250);" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path>
                            </svg>
                            <div>
                                <div class="text-xs text-gray-400">Comments</div>
                                <div class="font-semibold">${post.comments.toLocaleString()}</div>
                            </div>
                        </div>

                        <div class="flex items-center gap-2">
                            <svg class="w-4 h-4" style="color: rgb(74, 222, 128);" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"></path>
                            </svg>
                            <div>
                                <div class="text-xs text-gray-400">Reposts</div>
                                <div class="font-semibold">${post.reposts.toLocaleString()}</div>
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
    </script>
</body>
</html>
